<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abiba Terminal | Secure Banking AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <script src="security.js"></script>
    <style>
        :root {
            --bg-deep: #05070a;
            --accent-blue: #00d2ff;
            --accent-purple: #9d50bb;
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        body {
            background-color: var(--bg-deep);
            color: #ffffff;
            font-family: 'Inter', sans-serif;
            overflow: hidden;
            height: 100vh;
            height: 100svh;
        }

        h1,
        h2,
        h3,
        .brand-font {
            font-family: 'Outfit', sans-serif;
        }

        .glass {
            background: var(--glass-bg);
            -webkit-backdrop-filter: blur(16px);
            backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
        }

        .custom-cursor {
            width: 20px;
            height: 20px;
            background: var(--accent-blue);
            border-radius: 50%;
            position: fixed;
            pointer-events: none;
            z-index: 9999;
            mix-blend-mode: difference;
            transition: transform 0.1s ease;
        }

        .chat-container::-webkit-scrollbar {
            width: 4px;
        }

        .chat-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.02);
        }

        .chat-container::-webkit-scrollbar-thumb {
            background: rgba(0, 210, 255, 0.2);
            border-radius: 10px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #10b981;
            box-shadow: 0 0 10px #10b981;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 0.4;
            }

            100% {
                opacity: 1;
            }
        }

        .metric-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 2px;
            overflow: hidden;
        }

        .metric-fill {
            height: 100%;
            background: var(--accent-blue);
            width: 0%;
            transition: width 1.5s ease;
        }
    </style>
</head>

<body class="flex flex-col md:flex-row p-4 md:p-6 gap-6">

    <div class="custom-cursor hidden md:block" id="cursor"></div>

    <!-- Sidebar Dashboard -->
    <aside class="hidden lg:flex w-80 glass rounded-[32px] flex-col p-8 overflow-hidden relative">
        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-cyan-500 to-purple-500"></div>

        <div class="flex items-center space-x-3 mb-12">
            <button onclick="window.location.href='index.html'"
                class="p-2 hover:bg-white/5 rounded-full transition-colors mr-2">
                <i data-lucide="arrow-left" class="w-5 h-5"></i>
            </button>
            <div class="brand-font font-bold text-xl tracking-tighter">ABIBA <span
                    class="text-[10px] text-cyan-500 block -mt-1 tracking-widest uppercase">Terminal</span></div>
        </div>

        <div class="space-y-8 flex-1">
            <div class="space-y-4">
                <p class="text-[10px] text-gray-500 font-bold tracking-[0.2em] uppercase">System Health</p>
                <div class="glass p-4 rounded-2xl flex items-center justify-between">
                    <span class="text-xs">Neuro-Core</span>
                    <div class="flex items-center space-x-2">
                        <span class="text-[10px] text-gray-500 uppercase">Online</span>
                        <div class="status-dot"></div>
                    </div>
                </div>
                <div class="glass p-4 rounded-2xl flex items-center justify-between">
                    <span class="text-xs">Finacle Sync</span>
                    <div class="flex items-center space-x-2">
                        <span class="text-[10px] text-gray-500 uppercase">Latency 14ms</span>
                        <div class="status-dot"></div>
                    </div>
                </div>
            </div>

            <div class="space-y-4">
                <p class="text-[10px] text-gray-500 font-bold tracking-[0.2em] uppercase">Banking Metrics</p>
                <div class="space-y-4">
                    <div>
                        <div class="flex justify-between text-[10px] mb-2">
                            <span>NPA Risk Analysis</span>
                            <span class="text-cyan-400">Low</span>
                        </div>
                        <div class="metric-bar">
                            <div class="metric-fill" id="metric-npa"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between text-[10px] mb-2">
                            <span>Cognitive Load</span>
                            <span class="text-purple-400">12.4%</span>
                        </div>
                        <div class="metric-bar">
                            <div class="metric-fill" id="metric-load"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between text-[10px] mb-2">
                            <span>Fraud Prevention</span>
                            <span class="text-green-400">99.9%</span>
                        </div>
                        <div class="metric-bar">
                            <div class="metric-fill" id="metric-fraud"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-auto pt-8 border-t border-white/5">
            <div class="flex items-center space-x-3 opacity-50">
                <div class="w-8 h-8 rounded-full bg-cyan-500/20 flex items-center justify-center">
                    <i data-lucide="shield" class="w-4 h-4 text-cyan-400"></i>
                </div>
                <div class="text-[10px] uppercase font-bold tracking-widest">On-Prem Security</div>
            </div>
            <a href="logs.html"
                class="flex items-center space-x-3 mt-4 hover:bg-white/5 p-2 rounded-xl transition-colors">
                <div class="w-8 h-8 rounded-full bg-purple-500/20 flex items-center justify-center">
                    <i data-lucide="terminal" class="w-4 h-4 text-purple-400"></i>
                </div>
                <div class="text-[10px] uppercase font-bold tracking-widest text-gray-400">System Logs</div>
            </a>
        </div>
    </aside>

    <!-- Main Chat Terminal -->
    <main class="flex-1 flex flex-col glass rounded-[32px] overflow-hidden relative">
        <!-- Floating Glow -->
        <div class="absolute -top-40 -right-40 w-96 h-96 bg-cyan-500/10 rounded-full blur-[100px]"></div>

        <!-- Header -->
        <header class="p-6 md:p-8 flex items-center justify-between border-b border-white/5 bg-white/[0.01]">
            <div class="flex items-center space-x-4">
                <div
                    class="w-12 h-12 rounded-full bg-gradient-to-tr from-cyan-500 to-purple-500 flex items-center justify-center relative shadow-[0_0_20px_rgba(34,211,238,0.2)]">
                    <i data-lucide="brain-circuit" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                    <h2 class="font-bold text-lg leading-tight">ABIBA CORE v3.2</h2>
                    <div class="flex items-center space-x-2 mt-1">
                        <span class="w-2 h-2 rounded-full bg-cyan-500 animate-pulse"></span>
                        <span class="text-[10px] text-gray-400 font-bold uppercase tracking-wider">Neural Connection
                            Active</span>
                    </div>
                </div>
            </div>

            <div class="flex space-x-2">
                <button class="p-3 glass rounded-xl hover:bg-white/10 transition-colors hidden md:block"
                    title="Clear Context">
                    <i data-lucide="eraser" class="w-4 h-4 text-gray-400"></i>
                </button>
                <button class="p-3 glass rounded-xl hover:bg-white/10 transition-colors" title="Settings">
                    <i data-lucide="settings" class="w-4 h-4 text-gray-400"></i>
                </button>
            </div>
        </header>

        <!-- Message History -->
        <div id="chatHistory" class="flex-1 overflow-y-auto p-6 md:p-10 space-y-8 chat-container relative z-10">
            <!-- Abiba Intro -->
            <div class="flex items-start max-w-3xl animate-in fade-in slide-in-from-bottom-4 duration-500">
                <div
                    class="w-10 h-10 rounded-full bg-white/5 border border-white/10 flex items-center justify-center mr-4 shrink-0">
                    <i data-lucide="bot" class="w-5 h-5 text-cyan-400"></i>
                </div>
                <div class="glass p-6 rounded-3xl rounded-tl-none border-white/5">
                    <p class="text-sm md:text-base text-gray-200 leading-relaxed font-light">
                        Greetings. Terminal synchronized. I am <span class="text-cyan-400 font-bold">Abiba</span>.
                        My neural processors are ready to interface with your banking suites.

                        <span
                            class="block mt-4 text-[10px] md:text-xs text-gray-500 uppercase tracking-[0.2em] font-bold">Suggestions:</span>
                    <div class="flex flex-wrap gap-2 mt-3">
                        <button onclick="usePrompt('Analyze current NPA trends')"
                            class="text-[10px] border border-white/10 px-3 py-1.5 rounded-full hover:bg-cyan-500 hover:text-black transition-all">Analyze
                            NPAs</button>
                        <button onclick="usePrompt('System health check')"
                            class="text-[10px] border border-white/10 px-3 py-1.5 rounded-full hover:bg-cyan-500 hover:text-black transition-all">System
                            Health</button>
                        <button onclick="usePrompt('Generate fraud risk report')"
                            class="text-[10px] border border-white/10 px-3 py-1.5 rounded-full hover:bg-cyan-500 hover:text-black transition-all">Fraud
                            Report</button>
                    </div>
                    </p>
                </div>
            </div>
        </div>

        <!-- Input Area -->
        <div class="p-6 md:p-10 relative bg-white/[0.02]">
            <div class="relative max-w-5xl mx-auto group">
                <div
                    class="absolute inset-0 bg-cyan-500/5 blur-2xl rounded-full opacity-0 group-focus-within:opacity-100 transition-opacity">
                </div>

                <div
                    class="relative glass rounded-full overflow-hidden flex items-center pr-2 pl-6 py-2 border-white/10 focus-within:border-cyan-500/50 transition-colors">
                    <input type="text" id="userInput" placeholder="Ask Abiba to automate a task or visualize data..."
                        class="flex-1 bg-transparent border-none outline-none py-3 text-sm placeholder:text-gray-500 font-light pr-4">

                    <div class="flex items-center space-x-2">
                        <button
                            class="p-2 hover:bg-white/5 rounded-full transition-colors text-gray-500 hover:text-cyan-400">
                            <i data-lucide="paperclip" class="w-5 h-5"></i>
                        </button>
                        <button onclick="processInput()"
                            class="bg-cyan-500 text-black px-6 py-3 rounded-full font-bold text-xs md:text-sm hover:bg-cyan-400 transition-all flex items-center space-x-2 shadow-[0_0_20px_rgba(6,182,212,0.3)]">
                            <span>SEND</span>
                            <i data-lucide="send" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>

                <p class="text-center mt-4 text-[9px] uppercase tracking-[0.3em] font-bold text-gray-600">
                    Neural processing active â€¢ On-Premise Protection Enabled
                </p>
            </div>
        </div>
    </main>

    <script>
        // Initialize
        lucide.createIcons();

        // Custom Cursor
        const cursor = document.getElementById('cursor');
        document.addEventListener('mousemove', (e) => {
            gsap.to(cursor, { x: e.clientX, y: e.clientY, duration: 0.1 });
        });

        // Animations for Metrics
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById('metric-npa').style.width = '24%';
                document.getElementById('metric-load').style.width = '12%';
                document.getElementById('metric-fraud').style.width = '99%';
            }, 500);
        });

        // Chat Logic
        const chatHistory = document.getElementById('chatHistory');
        const userInput = document.getElementById('userInput');

        function usePrompt(text) {
            userInput.value = text;
            processInput();
        }

        function processInput() {
            const val = userInput.value.trim();
            if (!val) return;

            addMessage(val, true);
            userInput.value = '';

            // Simulate Loading
            const loadingId = 'loading-' + Date.now();
            addLoading(loadingId);

            setTimeout(() => {
                document.getElementById(loadingId).remove();
                addAbibaResponse(val);
            }, 1500);
        }

        function addMessage(text, isUser) {
            const msgDiv = document.createElement('div');
            msgDiv.className = `flex items-start max-w-3xl ${isUser ? 'ml-auto flex-row-reverse' : ''} animate-in fade-in slide-in-from-bottom-2`;

            msgDiv.innerHTML = `
                <div class="${isUser ? 'ml-4' : 'mr-4'} w-10 h-10 rounded-full ${isUser ? 'bg-cyan-500 text-black' : 'bg-white/5 border border-white/10'} flex items-center justify-center shrink-0">
                    <i data-lucide="${isUser ? 'user' : 'bot'}" class="w-5 h-5 ${isUser ? '' : 'text-cyan-400'}"></i>
                </div>
                <div class="glass p-6 rounded-3xl ${isUser ? 'rounded-tr-none border-cyan-500/20' : 'rounded-tl-none border-white/5'}">
                    <p class="text-sm md:text-base text-gray-200 leading-relaxed font-light">${text}</p>
                </div>
            `;
            chatHistory.appendChild(msgDiv);
            lucide.createIcons();
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }

        function addLoading(id) {
            const loadDiv = document.createElement('div');
            loadDiv.id = id;
            loadDiv.className = 'flex items-center space-x-2 text-cyan-500 italic text-xs animate-pulse opacity-50 px-14';
            loadDiv.innerHTML = '<i data-lucide="loader-2" class="w-3 h-3 animate-spin"></i><span>Abiba is thinking...</span>';
            chatHistory.appendChild(loadDiv);
            lucide.createIcons();
        }

        async function addAbibaResponse(input) {
            try {
                const response = await fetch('http://localhost:5000/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: input })
                });

                if (!response.ok) throw new Error('Backend offline');

                const data = await response.json();
                addMessage(data.response, false);

                if (data.mode === 'simulation') {
                    console.warn("Abiba running in Simulation Mode. Provide GROQ_API_KEY for live cognitive intelligence.");
                }
            } catch (error) {
                console.error("Connectivity error:", error);
                addMessage("I am currently experiencing a synchronization delay with the Neuro-Core. Please ensure the backend is active.", false);
            }
        }

        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') processInput();
        });
    </script>
</body>

</html>